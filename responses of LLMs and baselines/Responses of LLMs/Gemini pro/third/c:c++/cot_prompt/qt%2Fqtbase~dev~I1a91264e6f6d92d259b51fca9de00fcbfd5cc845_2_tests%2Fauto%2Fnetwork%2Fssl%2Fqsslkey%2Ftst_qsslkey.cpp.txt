The `setPrivateKeyHandle` and `setCertificateHandle` methods in `OpenSSLEngineControl` do not properly free the EVP_PKEY and X509 handles when they are set to a new value. This can lead to memory leaks and potential security vulnerabilities.\n\nThe following code should be added to the `setPrivateKeyHandle` and `setCertificateHandle` methods to free the old handles:\n\n```cpp\nvoid OpenSSLEngineControl::setPrivateKeyHandle(EVP_PKEY *keyHandle)\n{\n    if (privateKeyHandle) {\n        EVP_PKEY_free(privateKeyHandle);\n    }\n    privateKeyHandle = keyHandle;\n}\n\nvoid OpenSSLEngineControl::setCertificateHandle(X509 *certHandle)\n{\n    if (certificateHandle) {\n        X509_free(certificateHandle);\n    }\n    certificateHandle = certHandle;\n}\n```\n\nAdditionally, the `~OpenSSLEngineControl` destructor should also free the EVP_PKEY and X509 handles:\n\n```cpp\nOpenSSLEngineControl::~OpenSSLEngineControl()\n{\n    if (privateKeyHandle) {\n        EVP_PKEY_free(privateKeyHandle);\n    }\n    if (certificateHandle) {\n        X509_free(certificateHandle);\n    }\n}\n```