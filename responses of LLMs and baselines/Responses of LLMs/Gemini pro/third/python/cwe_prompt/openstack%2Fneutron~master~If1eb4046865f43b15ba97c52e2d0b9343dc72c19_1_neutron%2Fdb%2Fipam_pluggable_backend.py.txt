Line 67-89: This code handles the deallocation of IP addresses over IPAM. If any single IP deallocation fails, it tries to allocate all deallocated IP addresses with the fixed IP request. This is considered a CWE-244: Failure in the Correct Implementation of Business Logic as it does not properly handle the failure of deallocating a single IP address.

Line 110-149: This code handles the allocation of IP addresses over IPAM. If any single IP allocation fails, it tries to deallocate all allocated IP addresses. This is also considered a CWE-244: Failure in the Correct Implementation of Business Logic as it does not properly handle the failure of allocating a single IP address.