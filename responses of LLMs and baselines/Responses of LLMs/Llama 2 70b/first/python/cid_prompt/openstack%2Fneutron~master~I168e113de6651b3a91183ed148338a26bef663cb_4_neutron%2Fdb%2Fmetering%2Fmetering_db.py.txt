 No security defects are detected in the code.

However, I would like to point out a few things that could be improved:

1. Consistent naming conventions:
The naming conventions in the code are not consistent. For example, some variable names are camelCase, while others are separated by underscores. It's better to stick to a single convention throughout the code.
2. Type hints and annotations:
The function parameters and return types are not explicitly annotated. Adding type hints and annotations would make the code more readable and easier to understand, and would also help catch type-related errors at runtime.
3. Docstrings:
The code lacks docstrings for many functions, which makes it difficult to understand their purpose and usage without reading through the entire codebase. Adding docstrings would improve the code's readability and make it easier for others to understand and use.
4. Function signature:
Some functions have a large number of parameters, which can make the code harder to read and understand. Consider breaking down these functions into smaller functions with fewer parameters, or using a context object to store the common parameters.
5. Consistent indentation and spacing:
The code uses inconsistent indentation and spacing, which can make it harder to read and understand. It's better to use consistent indentation and spacing throughout the code.
6. Comments:
The code lacks comments in many places, which makes it difficult to understand what the code is doing without reading through the entire codebase. Adding comments would improve the code's readability and make it easier for others to understand and use.
7